import e from"./libraries/sanitize.js";import{rIC as t}from'./vendor/idlize/idle-callback-polyfills.mjs.js';(()=>{class i{constructor(e){this.rootEl=e,this.background=e.querySelector(".filter-menu__background"),this.filters=e.querySelectorAll(".filter-menu__filter-list li:not(.filter-menu__clear) input"),this.reset=e.querySelector(".filter-menu__reset"),this.submit=e.querySelector(".filter-menu__footer"),this.resetCheckbox=e.querySelector(".filter-menu__clear input"),this.openFilter=document.querySelector(".vita-post-categories__filter-button"),this.activeBodyClass="filter-menu-open",this.paramLabel="set_tag",this.background.addEventListener("click",this.toggleMenu.bind(this)),this.submit.addEventListener("click",this.filterResults.bind(this,!1)),this.reset.addEventListener("click",this.filterResults.bind(this,!0)),this.openFilter.addEventListener("click",this.toggleMenu.bind(this)),this.resetCheckbox.addEventListener("change",this.deselectInputs.bind(this)),this.filters.forEach((e=>{e.addEventListener("change",this.deselectResetInput.bind(this))}))}toggleMenu(){document.body.classList.contains(this.activeBodyClass)?document.body.classList.remove(this.activeBodyClass):document.body.classList.add(this.activeBodyClass)}deselectInputs(e){e.currentTarget.checked&&this.filters.forEach((e=>{e.checked=!1})),e.currentTarget.checked=!0}deselectResetInput(e){e.currentTarget.checked&&(this.resetCheckbox.checked=!1)}filterResults(t){const i=new URL(e.sanitizePathname(window.location.pathname),window.location.origin);this.filters.forEach((()=>{i.searchParams.delete(this.paramLabel)}),this),t||this.resetCheckbox.checked||this.filters.forEach((()=>{Array.from(this.rootEl.querySelectorAll('input[type="checkbox"]:checked')).forEach(((e,t)=>{const s=parseInt(e.getAttribute("value"),10);i.searchParams.set(`${this.paramLabel}[${t}]`,s)}),this)}),this),window.history.replaceState(null,document.title,decodeURI(i.toString())),location.reload()}}const s="filter-menu",r=document.querySelectorAll(`.${s}`);r.length&&t((()=>r.forEach((e=>new i(e,s)))))})();
